#include "mbnrg_2b_A1B3_A1B3_deg4_v1.h"

////////////////////////////////////////////////////////////////////////////////

namespace mbnrg_A1B3_A1B3_deg4 {

mbnrg_A1B3_A1B3_deg4_v1::mbnrg_A1B3_A1B3_deg4_v1(const std::string mon1, const std::string mon2) {

    // =====>> BEGIN SECTION CONSTRUCTOR <<=====
    // =>> PASTE RIGHT BELOW THIS LINE <==


    if (mon1 == "nh3" and mon2 == "nh3") {
        coefficients = std::vector<double> {
             3.304659424052836e+00, // 0
             2.768241935822531e+02, // 1
             9.262421955368754e+02, // 2
            -4.357449864935108e+02, // 3
             1.451542321089050e+02, // 4
            -9.975811551608753e+01, // 5
            -9.464005056124572e+02, // 6
            -3.659737564185127e+02, // 7
            -5.482559771261548e+02, // 8
             4.577822514376624e+02, // 9
             9.044657435955558e+02, // 10
            -2.891250473436491e+02, // 11
            -1.995505805920339e+02, // 12
             2.449858244539585e+02, // 13
            -1.377424281486512e+03, // 14
             3.407042702663555e+02, // 15
            -4.953327740314691e+02, // 16
             5.167029143102739e+02, // 17
             1.175395981865430e+02, // 18
             1.137749999744187e+02, // 19
             4.010448605828282e+02, // 20
             2.998558302341117e+01, // 21
            -4.793247211181803e+02, // 22
             6.985448753771707e+02, // 23
             5.321847431732447e+02, // 24
             5.523111078727630e+02, // 25
            -4.088840504625654e+01, // 26
             8.717069301780593e+02, // 27
            -3.164704445513183e+02, // 28
            -9.207788554075863e+02, // 29
            -7.150841520961400e+02, // 30
             1.432098279481297e+03, // 31
             2.059686447767527e+03, // 32
            -8.686945805206337e+02, // 33
            -4.705773625252839e+02, // 34
            -8.778847597476935e+02, // 35
            -4.164317449981804e+02, // 36
            -1.168407746576328e+03, // 37
             2.844005857882732e+02, // 38
            -1.205032343891079e+03, // 39
             3.319129052755819e+02, // 40
             1.026428957609412e+03, // 41
            -1.179170244195952e+02, // 42
            -1.046695498142860e+03, // 43
            -1.875007177789626e+03, // 44
             6.727802988968839e+02, // 45
             5.407709200446067e+02, // 46
            -1.314513146995620e+03, // 47
            -3.065425372647185e+02, // 48
            -2.346176711782986e+03, // 49
            -7.338441122837845e+02, // 50
            -2.579139854284124e+03, // 51
             6.677312520770023e+02, // 52
             4.995260684547355e+02, // 53
             5.472796500385522e+01, // 54
             1.089299524381936e+03, // 55
             4.899661714846075e+02, // 56
             3.527125332955473e+02, // 57
            -8.259382044895958e+01, // 58
            -9.960579619024620e+02, // 59
            -5.450867937278457e+02, // 60
            -1.300212973038935e+01, // 61
            -1.967999579663936e+01, // 62
            -1.517001024165108e+03, // 63
             3.564177506048600e+02, // 64
             2.713173419938282e+02, // 65
             1.111710260532120e+03, // 66
             7.202982324298223e+02, // 67
            -1.124004985753462e+02, // 68
            -7.890383254761327e+02, // 69
            -5.022643593696766e+02, // 70
             4.345437010333085e+02, // 71
            -3.868731655859557e+02, // 72
             2.234643229650211e+03, // 73
            -3.606708710893708e+02, // 74
             3.754773300625712e+02, // 75
            -1.661855809988732e+02, // 76
             4.242697805744939e+01, // 77
             9.713129431983994e+02, // 78
            -3.304754662253870e+02, // 79
            -4.382401306749938e+02, // 80
            -5.537337543930430e+02, // 81
             9.816805361771478e+02, // 82
             1.547484982257065e+02, // 83
             3.780785098034776e+02, // 84
            -7.664417598266893e+02, // 85
             1.376753537770751e+03, // 86
             7.739166712039914e+02, // 87
            -2.093008118990334e+03, // 88
            -1.152100279516602e+02, // 89
             1.207039358980272e+03, // 90
             1.647960986220692e+03, // 91
             1.571768398860723e+01, // 92
             1.998917737212721e+03, // 93
             7.502907170585432e+02, // 94
            -1.206770284810386e+03, // 95
            -3.442562662538994e+02, // 96
             8.333192197493285e+02, // 97
            -3.278497262209261e+02, // 98
             6.462786206994282e+02, // 99
             3.235395466110481e+02, // 100
             9.950439424802149e+02, // 101
            -6.041273694108830e+02, // 102
            -5.007370636529477e+02, // 103
            -1.127201487452486e+03, // 104
             1.074947673394165e+03, // 105
             6.868854283857058e+01, // 106
             1.181168867593714e+02, // 107
             3.252724879870921e+03, // 108
            -2.780291956130369e+02, // 109
            -1.737691117101212e+03, // 110
            -5.961132461752308e+02, // 111
             1.936608537998741e+02, // 112
            -1.096121140981246e+02, // 113
             5.509836857747734e+02, // 114
             1.485292986006546e+03, // 115
            -7.885522116647655e+02, // 116
             1.667939108936365e+03, // 117
            -1.109780273220540e+03, // 118
            -2.044325629241212e+03, // 119
             8.014705695191670e+01, // 120
             1.162794597537452e+03, // 121
             5.530030906357803e+02, // 122
            -5.785628773349524e+02, // 123
             9.230006234005354e+01, // 124
            -2.193445186474637e+02, // 125
             3.561282183821751e+02, // 126
             2.434560267496298e+02, // 127
             5.281830804364221e+01, // 128
             1.456800009218827e+03, // 129
            -1.397901974841106e+03, // 130
            -6.531530703287315e+02, // 131
             1.743085254167557e+02, // 132
             6.654268049874574e+02, // 133
             2.930842475199512e+02, // 134
            -1.066651891461194e+03, // 135
            -2.577206887698795e+02, // 136
             1.599206116845507e+02, // 137
            -7.472075150632161e+02, // 138
            -3.768587161320466e+02, // 139
            -3.368278554305693e+02, // 140
             5.645333033668963e+02, // 141
            -7.337003644225038e+02, // 142
             7.862572295620545e+02, // 143
             2.775640843475954e+02, // 144
             2.270090591323395e+02, // 145
             2.989255829072628e+02, // 146
             4.009449201099728e+02, // 147
            -1.517979343906497e+01, // 148
            -1.696876725489429e+02, // 149
             3.663957413628188e+02, // 150
             1.071548817061089e+03, // 151
            -1.390917513400817e+03, // 152
             3.994364786982586e+02, // 153
             7.824986856601731e+02, // 154
            -1.264089586168731e+03, // 155
            -8.421736889635663e+02, // 156
            -7.896218951944810e+02, // 157
            -2.349276239241271e+02, // 158
            -4.067048323003422e+02, // 159
             2.978783093582497e+02, // 160
            -4.396912505146303e+02, // 161
             5.934361288455109e+02, // 162
            -6.835515191323138e+02, // 163
            -1.034859291684011e+03, // 164
             8.952181893342672e+01, // 165
             1.384578265832666e+03, // 166
             1.016596967256020e+03, // 167
            -6.486987665048631e+02, // 168
            -1.197078902975551e+03, // 169
             8.148896351641501e+02, // 170
             1.466627331776793e+02, // 171
             1.434803294781697e+02, // 172
             5.516674460427013e+02, // 173
             1.231455222477900e+03, // 174
            -2.765274403771618e+02, // 175
             9.199326689819466e+01, // 176
            -1.614236348652852e+03, // 177
            -4.407529482873643e+01, // 178
            -9.877796989053353e+02, // 179
            -1.709012979045356e+03, // 180
            -1.772348700266237e+03, // 181
             1.518369346459238e+03, // 182
            -7.482800199294309e+00, // 183
             2.071242251541855e+03, // 184
            -8.584904307701196e+02, // 185
            -2.249373023500823e+02, // 186
            -4.926719921671474e+02, // 187
            -1.154066419133962e+03, // 188
             6.828439151033059e+02, // 189
            -2.164658727881138e+01, // 190
             1.489913825662193e+03, // 191
            -5.627613187702869e+02, // 192
             2.365547513821286e+03, // 193
             5.490695828078922e+01, // 194
             1.222806309009606e+03, // 195
             8.100956554402123e+02, // 196
            -1.186804595173303e+03, // 197
             5.862566422696904e+03, // 198
            -5.499573427940422e+02, // 199
            -1.382765708449484e+02, // 200
             3.585548724024439e+02, // 201
             5.558597876085681e+02, // 202
             6.901609061607060e+02, // 203
            -1.878066686675529e+03, // 204
             3.271416341308280e+01, // 205
            -1.405704946116710e+03, // 206
            -1.138954320223432e+03, // 207
             6.733960155712955e+03, // 208
             1.049287979894738e+03, // 209
            -4.109326887808291e+01, // 210
             4.121137970245617e+02, // 211
             8.611462035239865e+02, // 212
             5.002406475987142e+02, // 213
             1.696446005282074e+03, // 214
             4.388938108762778e+02, // 215
            -1.620600716276945e+02, // 216
            -6.574962600519600e+02, // 217
            -1.657292265724480e+02, // 218
             1.473920784763804e+03, // 219
             5.265309226382726e+02, // 220
            -2.091759766951441e+03, // 221
             1.486537934310775e+03, // 222
             1.354890638952158e+02, // 223
            -3.327971846262075e+02, // 224
            -9.721661117079885e+02, // 225
             3.557884062721727e+02, // 226
            -3.442551379700083e+02, // 227
             1.290872691420313e+03, // 228
            -1.117514509595716e+03, // 229
            -7.812174478789844e+02, // 230
             8.586691320330368e+02, // 231
             3.813883914016433e+02, // 232
             9.958543761339387e+02, // 233
             1.126117776379331e+03, // 234
             7.617902831708304e+02, // 235
            -1.135855556382251e+03, // 236
             6.747751379388694e+02, // 237
             9.287214004093616e+02, // 238
             7.483603762101536e+01, // 239
             1.261688229064205e+03, // 240
             5.041139841937071e+02, // 241
             8.360633135089721e+02, // 242
            -8.312677298764315e+02, // 243
             4.925093064700710e+02, // 244
            -7.319408893029968e+02, // 245
            -1.515338956154138e+03, // 246
             1.898592770075117e+02, // 247
             5.016900195963282e+02, // 248
            -4.002947617241868e+01, // 249
             2.630699854442650e+02, // 250
             4.197281401922917e+02, // 251
             1.744244913180772e+02, // 252
             1.009362395578180e+02, // 253
             1.088554913850494e+03, // 254
            -2.355995846785747e+02, // 255
             7.162648804982345e+01, // 256
             1.057967005695462e+02, // 257
            -2.427851493907413e+03, // 258
             2.786175758010796e+03, // 259
            -2.371924508903694e+03, // 260
            -5.325805520975578e+02, // 261
             8.921488264396044e+02, // 262
             3.213862565499947e+03, // 263
             3.579716575528832e+03, // 264
             1.035863391732452e+03, // 265
             1.423995841832993e+03, // 266
             2.306682933893905e+03, // 267
            -5.411676205528383e+02, // 268
            -1.508971338832056e+02, // 269
             6.778789668656618e+02, // 270
            -1.114202141429868e+02, // 271
             5.262319544069526e+02, // 272
             8.791435310380242e+02, // 273
             9.938567596252896e+02, // 274
            -1.671647695804590e+03, // 275
             8.499648019990786e+02, // 276
            -3.992274371806324e+02, // 277
             2.160263120867077e+03, // 278
             1.433225966308156e+03, // 279
            -5.979263424737206e+02, // 280
             1.798453392539265e+02, // 281
             7.669378658156859e+01, // 282
            -9.747882645150216e+02, // 283
            -5.543473614127638e+02, // 284
            -1.850154253998204e+03, // 285
            -4.269024495942917e+02, // 286
            -6.826721186424577e+02, // 287
             7.003316946893519e+02, // 288
            -2.725197753553169e+02, // 289
             8.313004544497751e+02, // 290
            -7.622381680643326e+02, // 291
            -1.168455271435613e+02, // 292
             2.175388510261992e+03, // 293
            -2.584967043381210e+01, // 294
             4.495815035875733e+02, // 295
             6.831827580821141e+02, // 296
            -7.654019405583065e+02, // 297
             7.915592390458306e+02, // 298
             1.234606101470215e+03, // 299
            -1.756233580641844e+02, // 300
             3.236510359452907e+02, // 301
            -8.939803846058829e+02, // 302
             7.226865225033575e+02, // 303
             1.710496359138350e+03, // 304
            -6.238935271307294e+02, // 305
            -2.653090918833597e+02, // 306
             2.759799380607666e+03, // 307
            -2.130059490836356e+03, // 308
             1.404984904615368e+02, // 309
            -1.121547103355850e+03, // 310
            -7.863667023292222e+02, // 311
             2.250717468828591e+02, // 312
            -3.402031175516485e+02, // 313
             2.122775549668836e+02, // 314
            -9.393779438970417e+02, // 315
             2.956031526425245e+02, // 316
             1.295861667169105e+03, // 317
            -1.215781505520375e+01, // 318
            -1.930436985331347e+02, // 319
            -1.202646448915801e+02, // 320
             6.826307549002706e+02, // 321
             1.860255117073632e+03, // 322
             9.557139613472522e+02, // 323
             7.338885799098507e+02, // 324
             3.522842043600838e+02, // 325
             8.737655957947101e+02, // 326
            -2.499902787834610e+01, // 327
            -2.724175597230836e+02, // 328
             7.986461390589888e+02, // 329
             9.577237744819275e+02, // 330
             2.126570224981634e+03, // 331
             3.312063247698593e+02, // 332
             2.062889571205133e+02, // 333
             3.051585231691626e+03, // 334
            -8.780695650566511e+01, // 335
            -7.072433541170958e+02, // 336
            -4.550392977224324e+02, // 337
             9.565945368727888e+02, // 338
             2.874043186940618e+02, // 339
            -5.228891178259719e+02, // 340
            -4.467830548747079e+02, // 341
             9.792015108954512e+02, // 342
             2.261686453979356e+02, // 343
            -3.791384128316240e+02, // 344
             1.532173430301733e+02, // 345
             1.034977493124912e+03, // 346
            -1.192226821131373e+03, // 347
             1.662550360368058e+03, // 348
             3.023302153309405e+02, // 349
             7.885889776673682e+01, // 350
            -7.050502001706632e+03, // 351
            -3.044124529788146e+03, // 352
            -2.463827714223027e+02, // 353
            -1.601182120544775e+03, // 354
             1.665210840197404e+02, // 355
             1.360700484541978e+03, // 356
             5.089232743164880e+02, // 357
             2.594941612422539e+02, // 358
             1.069385306714179e+03, // 359
            -2.183029889958416e+02, // 360
             2.259718939822980e+02, // 361
            -6.148787900236809e+03, // 362
            -1.023369610876419e+03, // 363
            -3.578072767862563e+02, // 364
            -4.386855336268393e+02, // 365
            -8.017173194650493e+02, // 366
            -6.485405649671217e+02, // 367
             1.218173232788063e+02, // 368
            -7.783738463711608e+02, // 369
             4.918873790404107e+02, // 370
             2.671872005252654e+02, // 371
            -3.214445068026828e+03, // 372
             5.171962717926008e+03, // 373
             4.621119631110529e+01, // 374
            -2.175249685403456e+02, // 375
            -8.391907389391680e+02, // 376
             5.308939552292085e+02, // 377
            -8.860184524109708e+02, // 378
            -3.540784006747842e+02, // 379
             1.041832977172945e+03, // 380
             6.449467164448962e+02, // 381
             1.279854004946830e+03, // 382
            -1.155900090489735e+03, // 383
            -6.083615691335198e+01, // 384
            -4.062806432713663e+03, // 385
            -1.335227347970961e+02, // 386
             8.151213179014086e+02, // 387
            -1.283113536712622e+03, // 388
             3.021192038289557e+03, // 389
             1.005433479660047e+03, // 390
             2.160209355931835e+03, // 391
            -7.210490405532800e+02, // 392
            -9.764157377098169e+02, // 393
            -5.944311475596277e+02, // 394
            -1.474941892654752e+03, // 395
             7.522972834853160e+00, // 396
            -2.473384901596661e+02, // 397
             4.084588534200490e+01, // 398
            -8.052908240207391e+02, // 399
             1.321005715113766e+02, // 400
            -1.347330500882967e+03, // 401
             5.742650501112164e+00, // 402
             3.569675000541200e+02, // 403
            -1.611432115170873e+03, // 404
             1.196228803989151e+03, // 405
             5.870444015875064e+02, // 406
            -3.753518874467669e+02, // 407
            -2.938747143108793e+02, // 408
            -7.756356498072104e+02, // 409
             3.244666590055084e+03, // 410
             1.509119503972710e+02, // 411
             1.646247976810555e+03, // 412
            -1.302846313246404e+03, // 413
             1.057004464653565e+03, // 414
            -1.457083690273982e+02, // 415
            -1.202927965365255e+03, // 416
            -7.653311961204939e+02, // 417
            -7.933696993867395e+02, // 418
            -4.202179271351646e+03, // 419
            -1.593562140958749e+02, // 420
            -3.662285429922959e+02, // 421
            -7.200160234378826e+02, // 422
            -2.415902794358250e+02, // 423
            -2.512188413261388e+03, // 424
             5.108459676153281e+01, // 425
            -2.467070540962931e+03, // 426
            -3.549024391379280e+02, // 427
            -3.081422374677777e+03, // 428
            -1.171490793100905e+02, // 429
            -7.408329250345346e+02, // 430
            -7.232405427096342e+02, // 431
            -1.020608964335240e+03, // 432
             7.255147810960459e+02, // 433
             3.028202311552121e+03, // 434
            -6.925689718687972e+02, // 435
             6.036945370395869e+01, // 436
             3.157779190892063e+01, // 437
            -9.703589220703822e+02, // 438
             1.583864584404861e+02, // 439
             3.080327909759133e+02, // 440
             2.565273548966629e+03, // 441
             2.234591880526130e+03, // 442
             2.162485676914307e+03, // 443
             2.421309990943421e+02, // 444
            -3.674100496817049e+02, // 445
             3.794138923316681e+02, // 446
            -4.052482706350320e+02, // 447
            -2.271946007014032e+02, // 448
            -2.515348575931777e+03, // 449
             2.903640471221498e+03, // 450
             1.744856376077693e+03, // 451
             1.249381914377998e+03, // 452
             1.090502607679968e+02, // 453
            -8.062989838592001e+02, // 454
            -4.580599271278973e+01, // 455
            -5.157399939286396e+02, // 456
            -1.608940795414112e+02, // 457
            -1.372213696895531e+03, // 458
             4.344355613746892e+02, // 459
            -3.296520056837543e+03, // 460
            -5.946322746023745e+02, // 461
             1.029824112509652e+03, // 462
             9.609797667206541e+02, // 463
            -5.000011284125462e+02, // 464
            -6.104289563858896e+02, // 465
            -2.909021624757005e+03, // 466
            -3.963910872244873e+02, // 467
            -3.634589949668003e+02, // 468
             1.846548534268448e+03, // 469
             5.102141886682310e+02, // 470
            -8.223317709015087e+02, // 471
            -1.880524914775875e+02, // 472
            -9.045723288545263e+02, // 473
             3.890429310582862e+02, // 474
            -2.573965724397588e+03, // 475
             8.904602633403347e+02, // 476
             1.430105692329332e+03, // 477
             6.059331430921009e+02, // 478
             2.063454974465171e+02, // 479
            -3.045252002238654e+02, // 480
             1.386802079145766e+03, // 481
             3.954758865699466e+02, // 482
            -4.839789339101114e+02, // 483
             4.393939602104338e+01, // 484
             4.083195767739795e+02, // 485
             1.170264591585867e+03, // 486
             3.407632858971749e+03, // 487
             2.453202617134836e+03, // 488
             1.270751999865760e+03, // 489
             7.319444926007641e+01, // 490
            -4.314844813421878e+02, // 491
            -7.154186754849939e+02, // 492
             2.245194601623386e+03, // 493
             8.545254820511547e+02, // 494
            -3.383223589718664e+02, // 495
            -3.926097553247213e+02, // 496
             5.735398783705237e+01, // 497
            -1.631864048869729e+03, // 498
            -1.251465686919812e+03, // 499
             6.174114911751984e+02, // 500
            -2.818399603387272e+02, // 501
             6.773427918311845e+02, // 502
            -1.016904646398359e+02, // 503
            -2.717883049427596e+03, // 504
            -1.123101562365689e+03, // 505
            -8.473550831222926e+02, // 506
             1.774632553515562e+03, // 507
            -1.889405612857469e+03, // 508
             7.323382220275192e+02, // 509
            -1.826675741400222e+02, // 510
             2.230737670595641e+02, // 511
            -3.375199273202607e+02, // 512
            -1.038656805634122e+03, // 513
             2.924214128584238e+02, // 514
             1.507439265259718e+03, // 515
             5.150026199006304e+02, // 516
            -2.387502334357748e+02, // 517
            -9.158067735493438e+02, // 518
             2.652714791047816e+02, // 519
            -1.979040602684686e+02, // 520
            -1.083330431893179e+03, // 521
            -1.100790531997114e+03, // 522
             1.560644533664436e+02, // 523
             1.178630886218893e+02, // 524
             6.814135099410655e+02, // 525
             5.217238813702364e+02, // 526
             1.952463631401039e+00, // 527
             4.753438077986290e+02, // 528
             1.327559992682691e+03, // 529
            -1.459695232870768e+03, // 530
            -2.324429257594442e+03, // 531
            -1.260300674620845e+02, // 532
            -2.613148571168398e+02, // 533
            -1.579888218066025e+02, // 534
             7.421184178182186e+02, // 535
             3.605718184815011e+02, // 536
             1.579532792778818e+02, // 537
            -1.004428117523548e+03, // 538
            -3.700757173967265e+02, // 539
            -6.244925637672013e+02, // 540
             9.917477766770772e+02, // 541
            -3.226423124910631e+02, // 542
             1.706790438065898e+02, // 543
            -3.601645088106754e+02, // 544
            -6.468700944029052e+02, // 545
            -3.338890096051715e+03, // 546
            -2.075936628120012e+03, // 547
            -6.424223881849332e+02, // 548
            -1.618796271609702e+03, // 549
            -3.512104670826477e+02, // 550
            -1.269197022900822e+03, // 551
            -6.693173862947427e+02, // 552
            -1.576282811152457e+03, // 553
             3.958400983741516e+02, // 554
             8.186111841964643e+02, // 555
             2.107738706135622e+03, // 556
             2.507703046929568e+03, // 557
            -2.552513763780426e+02, // 558
            -5.075877520759067e+02, // 559
            -1.135542241048883e+03, // 560
            -6.194351437526027e+02, // 561
             8.126468995865661e+02, // 562
            -5.615582799601754e+02, // 563
             9.884822056975369e+02, // 564
             1.500606426978738e+03, // 565
            -2.123459124644893e+03, // 566
            -4.918974855069618e+02, // 567
             2.008553067352064e+03, // 568
             3.312954713834405e+02, // 569
            -3.594657535037734e+02, // 570
             2.060247751859867e+03, // 571
            -1.193430227615947e+02, // 572
            -1.718642438428513e+03, // 573
            -6.725840860654156e+01, // 574
            -1.422393895529901e+03, // 575
            -3.115717450797252e+03, // 576
             1.530453777409571e+02, // 577
            -5.509871909367737e+02, // 578
             4.218486076430476e+03, // 579
             3.374987848613039e+03, // 580
             4.362224516602417e+02, // 581
             8.560224167920693e+02, // 582
             1.211417031545227e+02, // 583
            -3.821652314587175e+02, // 584
             5.992479039620911e+02, // 585
             2.616246052466678e+02, // 586
            -2.419247957610419e+02, // 587
             8.803218081711802e+02, // 588
            -8.486092242844819e+01, // 589
             9.927010976730051e+01, // 590
            -8.187534513974082e+01, // 591
            -3.465860512888284e+01, // 592
             7.306565563646217e+01, // 593
            -2.889782260227861e+03, // 594
             7.498225617113033e+02, // 595
            -7.354256675445703e+02, // 596
             6.593719575409581e+02, // 597
            -7.825416022503388e+02, // 598
            -1.566463864920521e+02, // 599
             7.257082029854880e+01, // 600
            -2.215889741130180e+02, // 601
             1.042771035725440e+03, // 602
            -7.515927578123988e+02, // 603
            -4.388162372753285e+02, // 604
             4.635337963828131e+03, // 605
             1.898033824171172e+01, // 606
             1.057662147119367e+03, // 607
             3.001701998459972e+02, // 608
            -3.111052390028250e+03, // 609
             9.837854966748390e+01, // 610
             1.420804839822603e+03, // 611
             1.008238245444384e+03, // 612
            -3.899228239763511e+02, // 613
             3.256251389718387e+02, // 614
             6.587523788011887e+01, // 615
             1.097594235319346e+02, // 616
            -2.174533929754530e+03, // 617
            -5.995871372396407e+02, // 618
             7.366072756405848e+02, // 619
             3.251733607137467e+02, // 620
            -6.278562867106411e+02, // 621
             8.619156368905255e+02, // 622
            -1.710301801985167e+03, // 623
            -2.130089684579470e+03, // 624
            -7.746926944561178e+02, // 625
             9.684651454321686e+02, // 626
            -6.683731380726892e+02, // 627
             6.009122508329713e+02, // 628
            -7.700203586369104e+02, // 629
             4.373355586013091e+02, // 630
            -1.125425854519651e+03, // 631
            -7.120061250145168e+02, // 632
            -1.565295259428852e+03, // 633
             7.577994408636257e+02, // 634
            -1.668365595114622e+03, // 635
            -5.782850661784981e+02, // 636
            -5.309501856033052e+02, // 637
             4.296005078890516e+02, // 638
             1.450099895484242e+03, // 639
            -3.658649816808356e+02, // 640
            -4.372115436153570e+01, // 641
            -8.875416569815402e+02, // 642
             7.078053366665894e+02, // 643
            -9.045223426785238e+02, // 644
            -1.456817405591809e+02, // 645
            -2.742889076515969e+03, // 646
             1.504195742466729e+03, // 647
            -5.251845511124059e+02, // 648
            -3.212276178057866e+02, // 649
            -6.599710292140940e+02, // 650
             9.322493497235378e+02, // 651
             3.553734968744835e+02, // 652
             8.043354095073752e+02, // 653
             3.701755857189351e+02, // 654
            -8.316067527892221e+02, // 655
             4.144005235047835e+02, // 656
            -2.392176849258875e+03, // 657
             1.234941548843001e+02, // 658
             6.640258633860974e+02, // 659
             7.274153406864232e+02, // 660
             3.212605570349736e+01, // 661
            -2.114707821367032e+02, // 662
            -3.125438688390117e+02, // 663
             7.334582726165953e+02, // 664
             5.853354884302337e+02, // 665
             3.801143447733077e+02, // 666
            -4.122192319348725e+01, // 667
            -1.454587878765580e+03, // 668
            -5.280097843127511e+02, // 669
             3.825874554212709e+02, // 670
            -6.435727774766892e+02, // 671
            -3.439892964707555e+02, // 672
            -2.706951065932248e+02, // 673
            -7.116746351745979e+02, // 674
            -2.128714491125312e+02, // 675
             1.636563118948165e+03, // 676
             3.929067265532811e+01, // 677
             8.100192025065276e+02, // 678
            -2.202974903673216e+03, // 679
            -1.308860936857493e+03, // 680
             2.933565012246839e+02, // 681
            -8.296380481372225e+02, // 682
             7.233545490334824e+02, // 683
            -2.332866213119166e+03, // 684
            -3.997815293447901e+02, // 685
            -2.263129226655553e+03, // 686
             1.436732677787045e+03, // 687
            -5.141770695460524e+02, // 688
             1.972436270142974e+02, // 689
             1.088388301744060e+03, // 690
            -1.657099091132723e+03, // 691
            -2.952991403006630e+02, // 692
             7.823474098649184e+02, // 693
             1.796346911847983e+02, // 694
            -2.424470527925204e+03, // 695
            -2.420279279230181e+03, // 696
             1.896486233600651e+02, // 697
            -9.136536348259042e+01, // 698
             9.977970159298468e+02, // 699
             1.699615330618267e+02, // 700
             1.096406285610659e+03, // 701
             1.534544972557468e+02, // 702
            -5.523857263569123e+02, // 703
             1.236855480158836e+03, // 704
            -9.094705806857258e+02, // 705
            -1.504746123075177e+03, // 706
            -5.600458910188715e+02, // 707
            -2.429823232251862e+03, // 708
             2.624855730455155e+02, // 709
             1.846992361355231e+03, // 710
             2.345991210658073e+02, // 711
            -1.800188963900355e+03, // 712
            -7.291342209194046e+02, // 713
             4.708128103152341e+02, // 714
            -1.406389287200298e+03, // 715
            -8.681226973794257e+02, // 716
            -1.592100329112829e+03, // 717
             1.305129008734886e+03, // 718
             7.106539674868495e+02, // 719
             4.348508335669358e+02, // 720
            -2.989317216680124e+02, // 721
            -3.496291163174897e+01, // 722
            -1.091243535649123e+03, // 723
             4.066914924223140e+03, // 724
            -1.046596474268481e+03, // 725
            -2.386494025747853e+03, // 726
             6.167821271229923e+01, // 727
             1.120030286834372e+03, // 728
             1.063942621499307e+03, // 729
            -9.388556751304632e+02, // 730
            -1.444047869730232e+03, // 731
             1.427452736623649e+02, // 732
             6.537248460126414e+02, // 733
             1.212397595266567e+03, // 734
             3.490140617693584e+03, // 735
            -4.584589406545493e+02, // 736
            -1.733330473470415e+02, // 737
             7.681973905315780e+02, // 738
            -9.221462894064534e+02, // 739
             3.463577122822004e+03, // 740
            -5.257718211716756e+03, // 741
             2.138780572770664e+03, // 742
            -4.645642267472238e+02, // 743
             3.877192206326544e+02, // 744
             1.149129663630679e+02, // 745
             8.102847899961776e+02, // 746
             1.338566828394704e+03, // 747
             1.933199536408295e+03, // 748
             5.170573813935800e+02, // 749
             1.830411381950972e+03, // 750
            -9.014536190715696e+02, // 751
             7.973739135444055e+02, // 752
            -4.218784428686643e+02, // 753
             5.253042559686838e+02, // 754
            -1.842219550606264e+02, // 755
             2.753017732002740e+03, // 756
             4.560949927475796e+00, // 757
             1.769389065680517e+03, // 758
             1.210950097627059e+03, // 759
             2.954839062005526e+02, // 760
            -1.150772748927194e+02, // 761
            -1.159904684361539e+03, // 762
             1.537206518334435e+03, // 763
             5.595606700925240e+02, // 764
             9.339297051037111e+02, // 765
            -1.403169722884131e+03, // 766
             2.686834947238629e+03, // 767
             4.335475677475142e+02, // 768
            -3.750064795465430e+02, // 769
            -1.423409294835881e+03, // 770
             6.816267851888366e+00, // 771
            -3.205124721096736e+03, // 772
            -5.821073767082144e+02, // 773
             3.504954382419349e+03, // 774
             8.491726497590363e+01, // 775
            -4.092108731331014e+02, // 776
            -5.973374885484368e+02, // 777
             9.836525749139176e+01, // 778
             2.225769892097443e+03, // 779
             1.401467710862905e+02, // 780
            -1.320619185080217e+03, // 781
            -1.440305673916097e+03, // 782
            -3.633508153674462e+01, // 783
             1.340070237095282e+03, // 784
             1.281576827482581e+03, // 785
            -8.374284628109790e+02, // 786
            -4.531380541199521e+02, // 787
             2.215755062246054e+03, // 788
            -1.205378894426432e+03, // 789
             3.908881398034069e+02, // 790
             4.596708874648890e+03, // 791
            -1.769563030247853e+03, // 792
             6.308860784236691e+02, // 793
            -1.663710113091523e+03, // 794
             8.340843721276582e+01, // 795
             1.470794484705653e+02, // 796
            -4.175101010870604e+02, // 797
            -1.522412585251889e+03, // 798
             1.082378061362281e+03, // 799
            -1.177321079723254e+03, // 800
            -2.377433309805063e+03, // 801
             9.283284259015729e+02, // 802
            -1.156817336876092e+03, // 803
            -1.313042795603994e+03, // 804
             1.426263003013025e+03, // 805
            -3.089883473188952e+02, // 806
            -1.919104690726779e+02, // 807
            -2.405659580097436e+03, // 808
             5.007875670549829e+01, // 809
            -2.568908808155688e+03, // 810
            -6.585359257281445e+02, // 811
            -2.770224048679254e+03, // 812
             1.845653056896305e+03, // 813
             1.716212521023146e+03, // 814
            -5.387753527748085e+02, // 815
            -1.218190283520179e+03, // 816
             3.416798466322540e+03, // 817
             9.720542898373575e+02, // 818
             4.648386371697785e+02, // 819
             8.704823158543641e+02, // 820
             3.077138066725338e+02, // 821
            -5.966542990239791e+02, // 822
            -2.574426668007416e+03, // 823
            -4.457081311414579e+02, // 824
            -4.491929223478028e+02, // 825
            -2.499585677333139e+03, // 826
             3.098674783475636e+02, // 827
            -9.271840214710015e+02, // 828
            -4.908208296755053e+02, // 829
             6.720473110012151e+02, // 830
             4.180266456480783e+02, // 831
             2.963154079189633e+02, // 832
            -3.609883677894816e+02, // 833
             1.813207177700197e+03, // 834
            -1.657966706036237e+03, // 835
             1.285117841333297e+03, // 836
            -1.821021540582784e+02, // 837
            -1.260812620005012e+03, // 838
            -3.646632072137253e+02, // 839
             1.035722890015108e+03, // 840
             1.199579705879724e+03, // 841
             9.130408076329365e+02, // 842
             3.890404899647849e+02, // 843
            -8.521235496861889e+02, // 844
             4.573560291724842e+02, // 845
            -1.247692024599857e+02, // 846
             8.839978331705411e+02, // 847
             2.926115886202994e+02, // 848
             8.662947158308336e+02, // 849
             5.977922661714899e+02, // 850
             6.810845105322579e+02, // 851
            -3.904165974501526e+02, // 852
            -1.769160148225485e+03, // 853
             1.003921752674570e+03, // 854
             8.268229978579375e+02, // 855
            -5.073517320366619e+02, // 856
             1.470946142870889e+03, // 857
            -9.089811866948635e+02, // 858
             7.694896426581661e+02, // 859
             5.244457113473154e+02, // 860
             4.052645182796537e+03, // 861
            -8.234825200512320e+02, // 862
            -2.114185796122421e+02, // 863
             1.228668781376582e+03, // 864
             1.082825139256415e+03, // 865
             2.416363218166642e+02, // 866
            -9.420074477398374e+02, // 867
            -8.465655632017179e+02, // 868
             5.548885518344459e+03, // 869
             1.576758090175100e+03, // 870
            -1.240460535053080e+03, // 871
             1.908060496849191e+02, // 872
            -1.655295103806697e+03, // 873
            -8.134008864134698e+02, // 874
             2.074404853405305e+02, // 875
             3.960042183178666e+02, // 876
            -6.860564984807071e+01, // 877
             9.421301175597314e+02, // 878
            -1.138732831761617e+03, // 879
            -4.168338541769576e+02, // 880
             8.020540041387713e+02, // 881
            -6.224141216552983e+03, // 882
            -3.564380059612346e+02, // 883
            -2.501904283082658e+02, // 884
            -3.977461695937602e+02, // 885
             7.811922891309018e+01, // 886
             1.002498836880069e+03, // 887
            -3.206903735181685e+03, // 888
            -6.635638629492977e+02, // 889
             3.507480382181754e+03, // 890
             1.408504031158547e+03, // 891
             4.085253650024719e+02, // 892
             4.171812724521128e+02, // 893
            -1.422728220266432e+01, // 894
             4.807772740521830e+02, // 895
             6.371843795981181e+02, // 896
            -4.996807739829836e+01, // 897
             5.807630123600920e+02, // 898
            -1.034974694454894e+03, // 899
            -1.779668693495789e+03, // 900
            -2.417745121232634e+03, // 901
             4.772661238056746e+02, // 902
            -3.754388099313129e+02, // 903
             2.122135126805508e+03, // 904
             2.081959034367024e+03, // 905
             8.284091797424101e+02, // 906
            -4.594007651263799e+02, // 907
            -1.485600722406374e+03, // 908
            -4.091476347073154e+02, // 909
             1.208980773205382e+03, // 910
            -1.357808304180633e+03, // 911
            -7.818768956891914e+02, // 912
             8.134022159904484e+02, // 913
             2.043810943024233e+03, // 914
             1.057509412344566e+03, // 915
             8.149928840379938e+02, // 916
             4.433380721788838e+03, // 917
            -1.623858911501262e+03, // 918
             8.630271472181441e+02, // 919
             1.545522231572803e+03, // 920
             1.928386833800117e+03, // 921
            -2.028729070619069e+03, // 922
            -8.955176718136973e+02, // 923
             1.871712359024329e+03, // 924
             2.875449651037870e+02, // 925
            -2.905612195149527e+03, // 926
             4.781409229833723e+02, // 927
            -6.312404616332860e+02, // 928
             2.514150509510830e+03, // 929
            -5.457966109409788e+02, // 930
            -4.890090492565344e+02, // 931
            -1.655775392692613e+03, // 932
            -9.388139733516107e+02, // 933
             1.085678788041347e+02, // 934
             1.603200546524505e+03, // 935
             1.760934398810491e+01, // 936
             9.366478374495464e+02, // 937
             8.444277808829427e+02, // 938
             3.783197772300273e+02, // 939
             4.822911449352817e+03, // 940
             1.831463615883606e+03, // 941
             1.836252905850736e+02, // 942
             1.522207798310509e+03, // 943
            -1.170024119105621e+02, // 944
            -3.261003273116423e+02, // 945
             1.618423715320253e+03, // 946
            -2.681745066307521e+02, // 947
            -1.323786116013228e+03, // 948
            -2.887781857586260e+02, // 949
            -2.208064271718656e+02, // 950
             6.987997338487089e+02, // 951
             2.499599317630341e+02, // 952
             1.104365685727973e+03, // 953
            -2.085518614839984e+03, // 954
             1.171355081739599e+03, // 955
             3.519205122057770e+03, // 956
             1.129730231473009e+02, // 957
             2.465432958891816e+03, // 958
             8.413990447552622e+01, // 959
            -1.310890411083968e+03, // 960
             3.067239310133250e+03, // 961
             8.436254243407240e+02, // 962
             4.271085093358200e+02, // 963
             1.425808749663790e+03, // 964
            -3.145385550043993e+02, // 965
             1.164596889111416e+03, // 966
            -1.529297821744972e+02, // 967
            -2.992926934201832e+02, // 968
            -7.573803782747825e+02, // 969
            -4.197482715718912e+02, // 970
            -4.587935033379566e+03, // 971
             1.204298265047198e+03, // 972
             7.715537269283976e+02, // 973
            -9.147712646178757e+02, // 974
             3.736107207737487e+03, // 975
             2.330057321889336e+03, // 976
             1.282129810554845e+02, // 977
            -4.304308412210693e+02, // 978
            -9.852775577972833e+02, // 979
            -8.440243726780944e+02, // 980
             1.374565666105155e+03, // 981
             3.014282568439475e+02, // 982
             3.564436683556079e+02, // 983
            -3.323689790892135e+03, // 984
            -1.070068674830902e+03, // 985
            -6.019122476054496e+02, // 986
            -3.113466412801406e+03, // 987
            -1.805530655141283e+03, // 988
             2.766814294321234e+03, // 989
            -2.325557385914253e+03, // 990
             1.483228341421273e+03, // 991
            -7.100171312624556e+02, // 992
            -1.827650670232497e+03, // 993
            -2.925079961250684e+02, // 994
            -1.157186079717973e+03, // 995
            -3.079182295929920e+02, // 996
             1.481347034030804e+01, // 997
             1.554751524493549e+03, // 998
            -8.783138601184811e+02, // 999
             1.488934095416801e+03, // 1000
            -2.276482533128643e+02, // 1001
             4.046792091000524e+01, // 1002
             1.564754866881325e+02, // 1003
             1.350513884025484e+03, // 1004
            -3.607892572072766e+03, // 1005
            -4.620637310643064e+02, // 1006
             1.830969798821252e+03, // 1007
            -3.220416653996898e+02, // 1008
             6.228407546358349e+02, // 1009
             1.445454248662071e+03, // 1010
             2.006135074025887e+03, // 1011
             4.216504452014710e+01, // 1012
             1.428627217273069e+03, // 1013
            -1.097697659229095e+03, // 1014
            -3.082048453266081e+03, // 1015
            -2.884930776228794e+01, // 1016
             7.653474359843221e+02, // 1017
             2.681235378397856e+03, // 1018
            -1.250575931376419e+02, // 1019
            -2.035553099067764e+03, // 1020
             2.222772478263863e+02, // 1021
             1.009948674727843e+02, // 1022
             6.429043754984845e+03, // 1023
             7.342655847036623e+03, // 1024
            -1.122825403589795e+03, // 1025
             4.137615665337622e+03, // 1026
            -1.597016343074806e+03, // 1027
            -1.969816527251341e+03, // 1028
            -4.822797555517867e+03, // 1029
             1.767576475597135e+02, // 1030
             6.731113698225387e+02, // 1031
             1.199097634456718e+02, // 1032
            -2.878191459824388e+03, // 1033
            -9.582706789071349e+02, // 1034
            -3.184983080947003e+02, // 1035
            -1.585394809200445e+03, // 1036
            -4.933045654814359e+02, // 1037
            -1.001054494397137e+03, // 1038
            -2.794759451293431e+02, // 1039
            -2.623569422292438e+03, // 1040
             2.502899654196664e+02, // 1041
            -8.597649741414373e+02, // 1042
             5.016835889820271e+02, // 1043
            -1.745111109148826e+03, // 1044
            -1.003176380322568e+02, // 1045
            -3.891884171276276e+02, // 1046
             1.828787224769027e+03, // 1047
            -3.407250866964301e+02, // 1048
            -1.686041471094143e+03, // 1049
            -2.942188555806753e+02, // 1050
             4.997420751731078e+03, // 1051
             1.099712196750860e+03, // 1052
             2.400684563988190e+01, // 1053
             2.444821113852411e+03, // 1054
            -1.544854296797120e+02, // 1055
            -5.284599384402184e+02, // 1056
             2.043788836674984e+03, // 1057
            -5.176113085937650e+02, // 1058
             1.949333074120464e+03, // 1059
            -1.224409759311122e+03, // 1060
             3.561206099611767e+02, // 1061
            -1.120898527464758e+03, // 1062
            -2.049874213852500e+03, // 1063
            -1.503405024732491e+02, // 1064
            -5.186206481179262e+03, // 1065
            -2.183753065888006e+02, // 1066
             1.785028575637032e+03, // 1067
            -3.641592327895189e+02, // 1068
            -1.989695705754713e+03, // 1069
            -1.872337655457961e+03, // 1070
            -2.981204263819876e+03, // 1071
             5.980245059082936e+02, // 1072
            -7.094591254619403e+02, // 1073
            -4.555916003175900e+02, // 1074
             1.808585403830844e+02, // 1075
             1.241095221770663e+03, // 1076
             6.856017764605908e+02, // 1077
            -5.318464095872906e+02, // 1078
             4.356634045316371e+02, // 1079
            -8.382612459697132e+02, // 1080
             1.142432603268924e+02, // 1081
             4.389405220256588e+02, // 1082
            -6.422188611483917e+02, // 1083
            -1.481760555874411e+03, // 1084
             3.409693865020896e+02, // 1085
             1.830045893138331e+03, // 1086
            -1.542815343410992e+03, // 1087
             1.337245744520919e+02, // 1088
             1.457563275770137e+02, // 1089
            -2.145957629994555e+03, // 1090
             1.162499821724177e+01, // 1091
             1.732594188248974e+03, // 1092
            -1.624937572123358e+03, // 1093
             3.250738617740434e+03, // 1094
             2.542470225355085e+03, // 1095
            -9.549995090434861e+02, // 1096
             9.789944876330790e+02, // 1097
             1.292196573115463e+03, // 1098
            -1.061009096763765e+03, // 1099
            -2.119717688659733e+03, // 1100
            -2.820146234634950e+02, // 1101
             1.186258531885169e+03, // 1102
             1.197706202929424e+03, // 1103
             2.360257329533898e+02, // 1104
             1.728763911358737e+03, // 1105
             7.809824285396774e+02, // 1106
             1.172269833260784e+03, // 1107
            -9.003139256043423e+02, // 1108
            -6.618363100109857e+02, // 1109
            -2.494699493307350e+02, // 1110
             1.383214958339230e+03, // 1111
            -9.723767418656523e+02, // 1112
            -1.547627613076507e+03, // 1113
            -7.876345895572030e+02}; // 1114
    m_k_x_inter_A_A_0 =  9.924408822549835e-02; // A^(-1))
    m_k_x_intra_A_B_1 =  7.291517623301337e-01; // A^(-1))
    m_k_x_inter_A_B_0 =  2.631532387493592e-02; // A^(-1))
    m_k_x_intra_B_B_1 =  6.047227074177769e-01; // A^(-1))
    m_k_x_inter_B_B_0 =  3.102953703229596e-03; // A^(-1))
    m_ri =  7.000000000000000e+00; // A
    m_ro =  8.000000000000000e+00; // A

    } // end if mon1 == "nh3" and mon2 == "nh3"
    // =====>> END SECTION CONSTRUCTOR <<=====
}

//----------------------------------------------------------------------------//

double mbnrg_A1B3_A1B3_deg4_v1::f_switch(const double r, double& g)
{
    if (r > m_ro) {
        g = 0.0;
        return 0.0;
    } else if (r > m_ri) {
        const double t1 = M_PI/(m_ro - m_ri);
        const double x = (r - m_ri)*t1;
        g = - std::sin(x)*t1/2.0;
        return (1.0 + std::cos(x))/2.0;
    } else {
        g = 0.0;
        return 1.0;
    }
}

//----------------------------------------------------------------------------//

 double mbnrg_A1B3_A1B3_deg4_v1::eval(const double *xyz1, const double *xyz2, const size_t n) {
    std::vector<double> energies(n,0.0);
    std::vector<double> energies_sw(n,0.0);

    std::vector<double> xyz(24);
    double sw = 0.0;
    polynomial my_poly;

    for (size_t j = 0; j < n; j++) {
        const double *mon1 = xyz1 + 12*j;
        const double *mon2 = xyz2 + 12*j;


        const double d12[3] =
                         {mon1[0] - mon2[0],
                          mon1[1] - mon2[1],
                          mon1[2] - mon2[2]};

        const double d12rsq = d12[0]*d12[0] + d12[1]*d12[1] + d12[2]*d12[2];
        const double d12r = std::sqrt(d12rsq);

        if (true  && d12r > m_ro ) {
             continue;
        }

        std::copy(mon1, mon1 + 12, xyz.begin() + 0);

        std::copy(mon2, mon2 + 12, xyz.begin() + 12);


        const double* coords_A_1_a = xyz.data() + 0;

        const double* coords_B_1_a = xyz.data() + 3;

        const double* coords_B_2_a = xyz.data() + 6;

        const double* coords_B_3_a = xyz.data() + 9;

        const double* coords_A_2_b = xyz.data() + 12;

        const double* coords_B_4_b = xyz.data() + 15;

        const double* coords_B_5_b = xyz.data() + 18;

        const double* coords_B_6_b = xyz.data() + 21;


        double w12 =     -9.721486914088159e-02;  //from MBpol
        double w13 =     -9.721486914088159e-02;
        double wcross =   9.859272078406150e-02;

    
        variable vs[28];

        double xs[28];

        xs[0] = vs[0].v_coul(m_k_x_inter_A_A_0, coords_A_1_a, coords_A_2_b);
        xs[1] = vs[1].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_1_a);
        xs[2] = vs[2].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_2_a);
        xs[3] = vs[3].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_3_a);
        xs[4] = vs[4].v_coul(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_4_b);
        xs[5] = vs[5].v_coul(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_5_b);
        xs[6] = vs[6].v_coul(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_6_b);
        xs[7] = vs[7].v_coul(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_1_a);
        xs[8] = vs[8].v_coul(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_2_a);
        xs[9] = vs[9].v_coul(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_3_a);
        xs[10] = vs[10].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_4_b);
        xs[11] = vs[11].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_5_b);
        xs[12] = vs[12].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_6_b);
        xs[13] = vs[13].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_2_a);
        xs[14] = vs[14].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_3_a);
        xs[15] = vs[15].v_coul(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_4_b);
        xs[16] = vs[16].v_coul(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_5_b);
        xs[17] = vs[17].v_coul(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_6_b);
        xs[18] = vs[18].v_exp(m_k_x_intra_B_B_1, coords_B_2_a, coords_B_3_a);
        xs[19] = vs[19].v_coul(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_4_b);
        xs[20] = vs[20].v_coul(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_5_b);
        xs[21] = vs[21].v_coul(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_6_b);
        xs[22] = vs[22].v_coul(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_4_b);
        xs[23] = vs[23].v_coul(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_5_b);
        xs[24] = vs[24].v_coul(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_6_b);
        xs[25] = vs[25].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_5_b);
        xs[26] = vs[26].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_6_b);
        xs[27] = vs[27].v_exp(m_k_x_intra_B_B_1, coords_B_5_b, coords_B_6_b);

        double gsw12 = 0.0;
        double sw12 = f_switch(d12r, gsw12);

        sw = sw12;

        energies[j] = my_poly.eval(xs,coefficients.data());
        energies_sw[j] = energies[j]*sw;

    }

    double energy = 0.0;
    for (size_t i = 0; i < n; i++)
        energy += energies_sw[i];

    return energy;

}

//----------------------------------------------------------------------------//

double mbnrg_A1B3_A1B3_deg4_v1::eval(const double *xyz1, const double *xyz2, double *grad1, double *grad2 , const size_t n, std::vector<double> *virial) {
    std::vector<double> energies(n,0.0);
    std::vector<double> energies_sw(n,0.0);

    std::vector<double> xyz(24);
    double sw = 0.0;
    polynomial my_poly;

    for (size_t j = 0; j < n; j++) {
        const double *mon1 = xyz1 + 12*j;
        const double *mon2 = xyz2 + 12*j;


        const double d12[3] =
                         {mon1[0] - mon2[0],
                          mon1[1] - mon2[1],
                          mon1[2] - mon2[2]};

        const double d12rsq = d12[0]*d12[0] + d12[1]*d12[1] + d12[2]*d12[2];
        const double d12r = std::sqrt(d12rsq);

        if (true  && d12r > m_ro ) {
             continue;
        }

        std::vector<double> gradients(24,0.0);

        std::copy(mon1, mon1 + 12, xyz.begin() + 0);

        std::copy(mon2, mon2 + 12, xyz.begin() + 12);
        const double* coords_A_1_a = xyz.data() + 0;

        const double* coords_B_1_a = xyz.data() + 3;

        const double* coords_B_2_a = xyz.data() + 6;

        const double* coords_B_3_a = xyz.data() + 9;

        const double* coords_A_2_b = xyz.data() + 12;

        const double* coords_B_4_b = xyz.data() + 15;

        const double* coords_B_5_b = xyz.data() + 18;

        const double* coords_B_6_b = xyz.data() + 21;


        double* coords_A_1_a_g = gradients.data() + 0;

        double* coords_B_1_a_g = gradients.data() + 3;

        double* coords_B_2_a_g = gradients.data() + 6;

        double* coords_B_3_a_g = gradients.data() + 9;

        double* coords_A_2_b_g = gradients.data() + 12;

        double* coords_B_4_b_g = gradients.data() + 15;

        double* coords_B_5_b_g = gradients.data() + 18;

        double* coords_B_6_b_g = gradients.data() + 21;



        double w12 =     -9.721486914088159e-02;  //from MBpol
        double w13 =     -9.721486914088159e-02;
        double wcross =   9.859272078406150e-02;

    
        variable vs[28];

        double xs[28];


        double gxs[28];

        xs[0] = vs[0].v_coul(m_k_x_inter_A_A_0, coords_A_1_a, coords_A_2_b);
        xs[1] = vs[1].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_1_a);
        xs[2] = vs[2].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_2_a);
        xs[3] = vs[3].v_exp(m_k_x_intra_A_B_1, coords_A_1_a, coords_B_3_a);
        xs[4] = vs[4].v_coul(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_4_b);
        xs[5] = vs[5].v_coul(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_5_b);
        xs[6] = vs[6].v_coul(m_k_x_inter_A_B_0, coords_A_1_a, coords_B_6_b);
        xs[7] = vs[7].v_coul(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_1_a);
        xs[8] = vs[8].v_coul(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_2_a);
        xs[9] = vs[9].v_coul(m_k_x_inter_A_B_0, coords_A_2_b, coords_B_3_a);
        xs[10] = vs[10].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_4_b);
        xs[11] = vs[11].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_5_b);
        xs[12] = vs[12].v_exp(m_k_x_intra_A_B_1, coords_A_2_b, coords_B_6_b);
        xs[13] = vs[13].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_2_a);
        xs[14] = vs[14].v_exp(m_k_x_intra_B_B_1, coords_B_1_a, coords_B_3_a);
        xs[15] = vs[15].v_coul(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_4_b);
        xs[16] = vs[16].v_coul(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_5_b);
        xs[17] = vs[17].v_coul(m_k_x_inter_B_B_0, coords_B_1_a, coords_B_6_b);
        xs[18] = vs[18].v_exp(m_k_x_intra_B_B_1, coords_B_2_a, coords_B_3_a);
        xs[19] = vs[19].v_coul(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_4_b);
        xs[20] = vs[20].v_coul(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_5_b);
        xs[21] = vs[21].v_coul(m_k_x_inter_B_B_0, coords_B_2_a, coords_B_6_b);
        xs[22] = vs[22].v_coul(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_4_b);
        xs[23] = vs[23].v_coul(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_5_b);
        xs[24] = vs[24].v_coul(m_k_x_inter_B_B_0, coords_B_3_a, coords_B_6_b);
        xs[25] = vs[25].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_5_b);
        xs[26] = vs[26].v_exp(m_k_x_intra_B_B_1, coords_B_4_b, coords_B_6_b);
        xs[27] = vs[27].v_exp(m_k_x_intra_B_B_1, coords_B_5_b, coords_B_6_b);

        double gsw12 = 0.0;
        double sw12 = f_switch(d12r, gsw12);

        sw = sw12;

        energies[j] = my_poly.eval(xs,coefficients.data(),gxs);
        energies_sw[j] = energies[j]*sw;

        for (size_t i = 0; i < 28; i++) {
            gxs[i] *= sw;
        }

        vs[0].grads(gxs[0], coords_A_1_a_g, coords_A_2_b_g, coords_A_1_a, coords_A_2_b);
        vs[1].grads(gxs[1], coords_A_1_a_g, coords_B_1_a_g, coords_A_1_a, coords_B_1_a);
        vs[2].grads(gxs[2], coords_A_1_a_g, coords_B_2_a_g, coords_A_1_a, coords_B_2_a);
        vs[3].grads(gxs[3], coords_A_1_a_g, coords_B_3_a_g, coords_A_1_a, coords_B_3_a);
        vs[4].grads(gxs[4], coords_A_1_a_g, coords_B_4_b_g, coords_A_1_a, coords_B_4_b);
        vs[5].grads(gxs[5], coords_A_1_a_g, coords_B_5_b_g, coords_A_1_a, coords_B_5_b);
        vs[6].grads(gxs[6], coords_A_1_a_g, coords_B_6_b_g, coords_A_1_a, coords_B_6_b);
        vs[7].grads(gxs[7], coords_A_2_b_g, coords_B_1_a_g, coords_A_2_b, coords_B_1_a);
        vs[8].grads(gxs[8], coords_A_2_b_g, coords_B_2_a_g, coords_A_2_b, coords_B_2_a);
        vs[9].grads(gxs[9], coords_A_2_b_g, coords_B_3_a_g, coords_A_2_b, coords_B_3_a);
        vs[10].grads(gxs[10], coords_A_2_b_g, coords_B_4_b_g, coords_A_2_b, coords_B_4_b);
        vs[11].grads(gxs[11], coords_A_2_b_g, coords_B_5_b_g, coords_A_2_b, coords_B_5_b);
        vs[12].grads(gxs[12], coords_A_2_b_g, coords_B_6_b_g, coords_A_2_b, coords_B_6_b);
        vs[13].grads(gxs[13], coords_B_1_a_g, coords_B_2_a_g, coords_B_1_a, coords_B_2_a);
        vs[14].grads(gxs[14], coords_B_1_a_g, coords_B_3_a_g, coords_B_1_a, coords_B_3_a);
        vs[15].grads(gxs[15], coords_B_1_a_g, coords_B_4_b_g, coords_B_1_a, coords_B_4_b);
        vs[16].grads(gxs[16], coords_B_1_a_g, coords_B_5_b_g, coords_B_1_a, coords_B_5_b);
        vs[17].grads(gxs[17], coords_B_1_a_g, coords_B_6_b_g, coords_B_1_a, coords_B_6_b);
        vs[18].grads(gxs[18], coords_B_2_a_g, coords_B_3_a_g, coords_B_2_a, coords_B_3_a);
        vs[19].grads(gxs[19], coords_B_2_a_g, coords_B_4_b_g, coords_B_2_a, coords_B_4_b);
        vs[20].grads(gxs[20], coords_B_2_a_g, coords_B_5_b_g, coords_B_2_a, coords_B_5_b);
        vs[21].grads(gxs[21], coords_B_2_a_g, coords_B_6_b_g, coords_B_2_a, coords_B_6_b);
        vs[22].grads(gxs[22], coords_B_3_a_g, coords_B_4_b_g, coords_B_3_a, coords_B_4_b);
        vs[23].grads(gxs[23], coords_B_3_a_g, coords_B_5_b_g, coords_B_3_a, coords_B_5_b);
        vs[24].grads(gxs[24], coords_B_3_a_g, coords_B_6_b_g, coords_B_3_a, coords_B_6_b);
        vs[25].grads(gxs[25], coords_B_4_b_g, coords_B_5_b_g, coords_B_4_b, coords_B_5_b);
        vs[26].grads(gxs[26], coords_B_4_b_g, coords_B_6_b_g, coords_B_4_b, coords_B_6_b);
        vs[27].grads(gxs[27], coords_B_5_b_g, coords_B_6_b_g, coords_B_5_b, coords_B_6_b);
        gsw12 *= (1.0)*energies[j]/d12r;


        for (size_t i = 0; i < 3; i++) {
            gradients[0 + i] += 0.0 + (gsw12*d12[i]);
            gradients[12 + i] += 0.0 - (gsw12*d12[i]);
        }


        for (size_t i = 0; i < 12; i++) {
            grad1[i + j*12] += gradients[0 + i];
        }


        for (size_t i = 0; i < 12; i++) {
            grad2[i + j*12] += gradients[12 + i];
        }

        
        if (virial != 0) {
        
            (*virial)[0] += -coords_A_1_a[0]*coords_A_1_a_g[0]
                        -coords_B_1_a[0]*coords_B_1_a_g[0]
                        -coords_B_2_a[0]*coords_B_2_a_g[0]
                        -coords_B_3_a[0]*coords_B_3_a_g[0]
                        -coords_A_2_b[0]*coords_A_2_b_g[0]
                        -coords_B_4_b[0]*coords_B_4_b_g[0]
                        -coords_B_5_b[0]*coords_B_5_b_g[0]
                        -coords_B_6_b[0]*coords_B_6_b_g[0];

        
            (*virial)[1] += -coords_A_1_a[0]*coords_A_1_a_g[1]
                        -coords_B_1_a[0]*coords_B_1_a_g[1]
                        -coords_B_2_a[0]*coords_B_2_a_g[1]
                        -coords_B_3_a[0]*coords_B_3_a_g[1]
                        -coords_A_2_b[0]*coords_A_2_b_g[1]
                        -coords_B_4_b[0]*coords_B_4_b_g[1]
                        -coords_B_5_b[0]*coords_B_5_b_g[1]
                        -coords_B_6_b[0]*coords_B_6_b_g[1];

        
            (*virial)[2] += -coords_A_1_a[0]*coords_A_1_a_g[2]
                        -coords_B_1_a[0]*coords_B_1_a_g[2]
                        -coords_B_2_a[0]*coords_B_2_a_g[2]
                        -coords_B_3_a[0]*coords_B_3_a_g[2]
                        -coords_A_2_b[0]*coords_A_2_b_g[2]
                        -coords_B_4_b[0]*coords_B_4_b_g[2]
                        -coords_B_5_b[0]*coords_B_5_b_g[2]
                        -coords_B_6_b[0]*coords_B_6_b_g[2];

        
            (*virial)[4] += -coords_A_1_a[1]*coords_A_1_a_g[1]
                        -coords_B_1_a[1]*coords_B_1_a_g[1]
                        -coords_B_2_a[1]*coords_B_2_a_g[1]
                        -coords_B_3_a[1]*coords_B_3_a_g[1]
                        -coords_A_2_b[1]*coords_A_2_b_g[1]
                        -coords_B_4_b[1]*coords_B_4_b_g[1]
                        -coords_B_5_b[1]*coords_B_5_b_g[1]
                        -coords_B_6_b[1]*coords_B_6_b_g[1];

        
            (*virial)[5] += -coords_A_1_a[1]*coords_A_1_a_g[2]
                        -coords_B_1_a[1]*coords_B_1_a_g[2]
                        -coords_B_2_a[1]*coords_B_2_a_g[2]
                        -coords_B_3_a[1]*coords_B_3_a_g[2]
                        -coords_A_2_b[1]*coords_A_2_b_g[2]
                        -coords_B_4_b[1]*coords_B_4_b_g[2]
                        -coords_B_5_b[1]*coords_B_5_b_g[2]
                        -coords_B_6_b[1]*coords_B_6_b_g[2];

        
            (*virial)[8] += -coords_A_1_a[2]*coords_A_1_a_g[2]
                        -coords_B_1_a[2]*coords_B_1_a_g[2]
                        -coords_B_2_a[2]*coords_B_2_a_g[2]
                        -coords_B_3_a[2]*coords_B_3_a_g[2]
                        -coords_A_2_b[2]*coords_A_2_b_g[2]
                        -coords_B_4_b[2]*coords_B_4_b_g[2]
                        -coords_B_5_b[2]*coords_B_5_b_g[2]
                        -coords_B_6_b[2]*coords_B_6_b_g[2];

            (*virial)[3] = (*virial)[1];
            (*virial)[6] = (*virial)[2];
            (*virial)[7] = (*virial)[5];


        }


    }

    double energy = 0.0;
    for (size_t i = 0; i < n; i++)
        energy += energies_sw[i];

    return energy;

}

//----------------------------------------------------------------------------//
} // namespace mbnrg_A1B3_A1B3_deg4
